[
  {
    "Id": "1350194",
    "ThreadId": "579789",
    "Html": "Hi there,<br />\nI am trying to build 835 using Interchange object using OopFactory.<br />\n<br />\nI written below lines of code.<br />\n<pre><code> var message = new Interchange(Convert.ToDateTime(&quot;01/01/03&quot;), 000905, false)\n            {\n                InterchangeSenderIdQualifier = &quot;ZZ&quot;,\n                InterchangeSenderId = &quot;SUBMITTERS.ID&quot;,\n                InterchangeReceiverIdQualifier = &quot;ZZ&quot;,\n                InterchangeReceiverId = &quot;RECEIVERS.ID&quot;,\n                SecurityInfo = &quot;SECRET&quot;,\n                SecurityInfoQualifier = &quot;01&quot;,\n            };\n            message.SetElement(12, &quot;00501&quot;);\n            message.SetElement(10, &quot;1253&quot;);\n            message.SetElement(11, &quot;^&quot;);\n\n            var group = message.AddFunctionGroup(&quot;HC&quot;, DateTime.Now, 1, &quot;005010X222&quot;);\n            group.ApplicationSendersCode = &quot;SENDER CODE&quot;;\n            group.ApplicationReceiversCode = &quot;RECEIVER CODE&quot;;\n            group.Date = Convert.ToDateTime(&quot;12/31/1999&quot;);\n            group.ControlNumber = 1;\n            group.SetElement(5, &quot;0802&quot;);\n\n\n            var transaction = group.AddTransaction(&quot;835&quot;, &quot;0001&quot;);\n            transaction.SetElement(2, &quot;0001&quot;);\n\n            var payeeIdentificationLoop = transaction.AddLoop(new TypedLoopN1());\n            payeeIdentificationLoop.N101_EntityIdentifierCode = &quot;PE&quot;;\n            payeeIdentificationLoop.N102_Name = &quot;REGIONAL HOPE HSPITA&quot;;\n            payeeIdentificationLoop.N103_IdentificationCodeQualifier = &quot;XX&quot;;\n            payeeIdentificationLoop.N104_IdentificationCode = &quot;64356540&quot;;</code></pre>\n\nBut on the line <strong>transaction.AddLoop(new TypedLoopN1())</strong> I am getting error saying <strong>Loop N1* could not be added because it could not be found in the specification for ST</strong>.<br />\n<br />\nI found specification for 835 5010 files as below from OopFactory project.<br />\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;\n&lt;TransactionSpecification xmlns=&quot;http://tempuri.org/X12ParserSpecification.xsd&quot; TransactionSetIdentifierCode=&quot;835&quot;&gt;\n  &lt;Segment SegmentId=&quot;BPR&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Segment SegmentId=&quot;TRN&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Segment SegmentId=&quot;CUR&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Segment SegmentId=&quot;DTM&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Segment SegmentId=&quot;PLB&quot; Trailer=&quot;true&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;Loop LoopId=&quot;1000A&quot; Usage=&quot;Required&quot; LoopRepeat=&quot;1&quot;&gt;\n    &lt;Name&gt;PAYER IDENTIFICATION&lt;/Name&gt;\n    &lt;StartingSegment SegmentId=&quot;N1&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;&gt;\n      &lt;EntityIdentifier Code=&quot;PR&quot;/&gt;\n    &lt;/StartingSegment&gt;\n    &lt;Segment SegmentId=&quot;N3&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;N4&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;4&quot;/&gt;\n    &lt;Segment SegmentId=&quot;PER&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;/Loop&gt;\n  &lt;Loop LoopId=&quot;1000B&quot; Usage=&quot;Required&quot; LoopRepeat=&quot;1&quot;&gt;\n    &lt;Name&gt;PAYEE IDENTFICATION&lt;/Name&gt;\n    &lt;StartingSegment SegmentId=&quot;N1&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;&gt;\n      &lt;EntityIdentifier Code=&quot;PE&quot;/&gt;\n    &lt;/StartingSegment&gt;\n    &lt;Segment SegmentId=&quot;N3&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;N4&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;4&quot;/&gt;\n    &lt;Segment SegmentId=&quot;RDM&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n  &lt;/Loop&gt;\n  &lt;Loop LoopId=&quot;2000&quot; Usage=&quot;Required&quot; Repeat=&quot;9999&quot;&gt;\n    &lt;Name&gt;HEADER NUMBER&lt;/Name&gt;\n    &lt;StartingSegment SegmentId=&quot;LX&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;TS3&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Segment SegmentId=&quot;TS2&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n    &lt;Loop LoopId=&quot;2100&quot;&gt;\n      &lt;Name&gt;CLAIM PAYMENT INFORMATION&lt;/Name&gt;\n      &lt;StartingSegment SegmentId=&quot;CLP&quot; Usage=&quot;Required&quot; Repeat=&quot;9999&quot;/&gt;\n      &lt;Segment SegmentId=&quot;CAS&quot; Usage=&quot;Situational&quot; Repeat=&quot;99&quot;/&gt;\n      &lt;Segment SegmentId=&quot;NM1&quot; Usage=&quot;Required&quot; Repeat=&quot;1&quot;/&gt;\n      &lt;Segment SegmentId=&quot;MIA&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n      &lt;Segment SegmentId=&quot;MOA&quot; Usage=&quot;Situational&quot; Repeat=&quot;1&quot;/&gt;\n      &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;5&quot;/&gt;\n      &lt;Segment SegmentId=&quot;DTM&quot; Usage=&quot;Situational&quot; Repeat=&quot;4&quot;/&gt;\n      &lt;Segment SegmentId=&quot;PER&quot; Usage=&quot;Situational&quot; Repeat=&quot;2&quot;/&gt;\n      &lt;Segment SegmentId=&quot;AMT&quot; Usage=&quot;Situational&quot; Repeat=&quot;13&quot;/&gt;\n      &lt;Segment SegmentId=&quot;QTY&quot; Usage=&quot;Situational&quot; Repeat=&quot;14&quot;/&gt;\n      &lt;Loop LoopId=&quot;2110&quot;&gt;\n        &lt;Name&gt;SERVICE PAYMENT INFORMATION&lt;/Name&gt;\n        &lt;StartingSegment SegmentId=&quot;SVC&quot; Usage=&quot;Situational&quot; Repeat=&quot;999&quot;/&gt;\n        &lt;Segment SegmentId=&quot;DTM&quot; Usage=&quot;Situational&quot; Repeat=&quot;2&quot;/&gt;\n        &lt;Segment SegmentId=&quot;CAS&quot; Usage=&quot;Situational&quot; Repeat=&quot;99&quot;/&gt;\n        &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;8&quot;/&gt;\n        &lt;Segment SegmentId=&quot;REF&quot; Usage=&quot;Situational&quot; Repeat=&quot;10&quot;/&gt;\n        &lt;Segment SegmentId=&quot;AMT&quot; Usage=&quot;Situational&quot; Repeat=&quot;9&quot;/&gt;\n        &lt;Segment SegmentId=&quot;QTY&quot; Usage=&quot;Situational&quot; Repeat=&quot;6&quot;/&gt;\n        &lt;Segment SegmentId=&quot;LQ&quot; Usage=&quot;Situational&quot; Repeat=&quot;99&quot;/&gt;\n      &lt;/Loop&gt;\n    &lt;/Loop&gt;\n  &lt;/Loop&gt;\n&lt;/TransactionSpecification&gt;</code></pre>\n\nI was trying to find out what is the problem and below one is my analysis. (I compared N1 of 835 to NM1 of 837 file)<br />\n<br />\nAs per my understanding NM1 loop can be multiple in 837 file - 1000A SUBMITTER NAME, 1000B RECEIVER NAME.  Same way 835 file N1 loop can be multiple - 1000A PAYER IDENTIFICATION, 1000B PAYEE IDENTIFICATION.<br />\n<br />\nIf we want to create NM1 loop for 837 file than we are passing entityIdentifier in constructor like below code.<br />\n<pre><code>transaction.AddLoop(new TypedLoopNM1(&quot;41&quot;)); //here 41 is entityIdentifier </code></pre>\n\nBut there is no option to pass entityIdentifier in constructor of TypedLoopN1 object. we can create object of N1 like below mentioned code. <br />\n<pre><code>transaction.AddLoop(new TypedLoopN1()); </code></pre>\n\nI debugged code and I found in Oopfactory below condition is not satisfying. (Inside  LoopContainer Class -&gt; GetLoopSpecification method)<br />\n<pre><code>matchingLoopSpecs.Where(ls =&gt; ls.StartingSegment.SegmentId == segment.SegmentId).Count() ==1</code></pre>\n\nAs per specification of 835, N1 can be two type. So here we are getting count as 2. So condition is not satisfying and its returning null and we are getting exception.<br />\n<br />\nLet me know if anything I am missing from my end.<br />\n",
    "PostedDate": "2015-02-09T01:10:40.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1480063",
    "ThreadId": "579789",
    "Html": "Did you ever get a response?  I am having the same issue with a 5010 834.<br />\n",
    "PostedDate": "2016-07-28T16:06:44.623-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]