[
  {
    "Id": "1144626",
    "ThreadId": "479297",
    "Html": "I want to start out by saying X12 Parser ROCKS.  I love the way this library is coded. GREAT JOB TEAM!\r<br />\n<br />\nPlease provide a working example of how to create a 5010 834 file from scratch.  I'm able to generate 837's with no problems. I received an error when trying to add multiple REF's to the file but was able to get passed that by modifying the source code.  I need some help and direction on where to go from here.<br />\n\r<br />\nThe following is what I have so far:<br />\n<pre><code>public void Generate834(DataTable MemberEligDT)\n        {\n            int LoopID = 0;\n            List&lt;string&gt; Errors = new List&lt;string&gt;();\n            if (MemberEligDT == null)\n                return;\n            DateTime startDT = DateTime.Now;\n\n            // Create a new interchange...\n            var message = new Interchange(startDT, 000905, false)\n            {\n                InterchangeSenderIdQualifier = &quot;01&quot;,\n                InterchangeSenderId = &quot;Blah Inc&quot;,\n                InterchangeReceiverIdQualifier = &quot;01&quot;,\n                InterchangeReceiverId = &quot;Blah 2 Inc.&quot;,\n                SecurityInfo = &quot;&quot;,\n                SecurityInfoQualifier = &quot;00&quot;,\n            };\n            message.SetElement(12, &quot;00501&quot;);\n            message.SetElement(10, &quot;1253&quot;);\n            message.SetElement(11, &quot;^&quot;);\n\n            var group = message.AddFunctionGroup(&quot;BE&quot;, DateTime.Now, 1, &quot;005010X220A1&quot;);\n            group.ApplicationSendersCode = &quot;9998503898&quot;;\n            group.ApplicationReceiversCode = &quot;0123456789&quot;;\n            group.Date = DateTime.Now;\n            group.ControlNumber = 1;\n            group.SetElement(5, &quot;0802&quot;);\n\n            int transactionnum = LoopID;\n            transactionnum++;\n            string TransNumString = string.Empty;\n\n            if (transactionnum &lt; 10)\n                TransNumString = &quot;0000&quot; + transactionnum.ToString();\n            else\n                TransNumString = &quot;000&quot; + transactionnum.ToString();\n\n            var transaction = group.AddTransaction(&quot;834&quot;, TransNumString);\n\n            transaction.SetElement(2, TransNumString);\n            transaction.SetElement(3, &quot;005010X220A1&quot;);\n\n            var bgnSegment = transaction.AddSegment(&quot;BGN&quot;);\n            bgnSegment.SetElement(1, &quot;00&quot;);\n            bgnSegment.SetElement(2, &quot;1&quot;);\n            DateTime NOWdt = DateTime.Now;\n            bgnSegment.SetElement(3, NOWdt.ToString(&quot;yyyyMMdd&quot;, CultureInfo.InvariantCulture));\n            bgnSegment.SetElement(4, DateTime.Now.ToString(&quot;hhmm&quot;, CultureInfo.InvariantCulture));\n            bgnSegment.SetElement(6, &quot;1&quot;);\n            bgnSegment.SetElement(8, &quot;4&quot;);\n\n            var sponsorLoop = transaction.AddLoop(new TypedLoopN1());\n            sponsorLoop.N101_EntityIdentifierCode = &quot;P5&quot;;\n            sponsorLoop.N102_Name = &quot;ACME Ins Co&quot;;\n            sponsorLoop.N103_IdentificationCodeQualifier = &quot;FI&quot;;\n            sponsorLoop.N104_IdentificationCode = &quot;PMED&quot;;\n\n            var partyIDLoop = transaction.AddLoop(new TypedLoopN1());\n            partyIDLoop.N101_EntityIdentifierCode = &quot;IN&quot;;\n            partyIDLoop.N103_IdentificationCodeQualifier = &quot;FI&quot;;\n            partyIDLoop.N104_IdentificationCode = &quot;999505788&quot;;\n\n            \n            \n            // Loop through the members...\n            for (int x = 0;x &lt; MemberEligDT.Rows.Count;x++)\n            {\n                var InsSegment = transaction.AddSegment(&quot;INS&quot;, true);\n                InsSegment.SetElement(1, &quot;Y&quot;);\n                InsSegment.SetElement(2, &quot;18&quot;);\n                InsSegment.SetElement(3, &quot;030&quot;);\n                InsSegment.SetElement(4, &quot;XN&quot;);\n                InsSegment.SetElement(5, &quot;A&quot;);\n                InsSegment.SetElement(6, &quot;A:0&quot;);\n                InsSegment.SetElement(8, &quot;AC&quot;);\n\n                var InsRefLoop1 = transaction.AddSegment(new TypedSegmentREF());\n                InsRefLoop1.REF01_ReferenceIdQualifier = &quot;REF&quot;;\n                InsRefLoop1.REF02_ReferenceId = &quot;0F&quot;;\n                InsRefLoop1.REF03_Description = &quot;00025907AVA&quot;;\n\n                var InsRefLoop2 = transaction.AddSegment(new TypedSegmentREF());\n                InsRefLoop2.REF01_ReferenceIdQualifier = &quot;REF&quot;;\n                InsRefLoop2.REF02_ReferenceId = &quot;17&quot;;\n                InsRefLoop2.REF03_Description = &quot;00025907AVA&quot;;\n\n                var MemberNM1 = transaction.AddLoop(new TypedLoopNM1(&quot;NM1&quot;));\n                MemberNM1.NM101_EntityIdCode = &quot;NM1&quot;;\n                MemberNM1.NM101_EntityIdentifierCodeEnum = EntityIdentifierCode.InsuredOrSubscriber;\n                MemberNM1.NM102_EntityTypeQualifier = EntityTypeQualifier.Person;\n                MemberNM1.NM103_NameLastOrOrganizationName = (string)MemberEligDT.Rows[x][&quot;FirstName&quot;];\n                MemberNM1.NM104_NameFirst = &quot;FIRST&quot;;\n                MemberNM1.NM105_NameMiddle = &quot;M&quot;;\n                \n            }\n            \n            string Output = message.SerializeToX12(true);\n        }</code></pre>\n\n",
    "PostedDate": "2014-01-02T06:57:43.663-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1193197",
    "ThreadId": "479297",
    "Html": "This discussion has been copied to a work item. Click <a href=\"https://x12parser.codeplex.com/workitem/1875\" rel=\"nofollow\">here</a> to go to the work item and continue the discussion.<br />\n",
    "PostedDate": "2014-01-23T06:54:05.147-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1286491",
    "ThreadId": "479297",
    "Html": "Please post your 837 generation code<br />\n",
    "PostedDate": "2014-08-05T06:01:13.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]